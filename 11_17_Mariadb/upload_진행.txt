


<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Insert title here</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js">
</script>

</head>
<body>

<h2> file upload 1 (c:/upload)</h2>

<form action="./upload1.do" method="post" enctype="multipart/form-data">
  <label>name : <input type="text" name="name">  </label> <br>
  <label>첨부파일 : <input type="file" name="myfile" multiple="multiple" > </label> <br>
  <br>
  <input type="submit">
  <input type="reset">
</form>
<hr>
<h2> file upload 2 (./upload) </h2>

<form action="./upload2.do" method="post" enctype="multipart/form-data">
  <label>name : <input type="text" name="name">  </label> <br>
  <label>첨부파일 : <input type="file" name="myfile" multiple="multiple"> </label> <br>
  <br>
  <input type="submit">
  <input type="reset">
</form>
</body>
</html>



**********************************************
@WebServlet("/upload1.do")
@MultipartConfig(location = "c:/upload",maxFileSize = 1024*1024*5)
public class UploadServlet1 extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
	protected void doPost(HttpServletRequest request, HttpServletResponse response) 
			                                         throws ServletException, IOException {
		System.out.println("/upload1.do  파일업로드처리");
		response.setContentType("text/html;charset=utf-8");
        request.setCharacterEncoding("utf-8"); 
        
        PrintWriter out  = response.getWriter();

        String name = request.getParameter("name");
       // String myfile = request.getParameter("myfile");
        
        Collection<Part> parts = request.getParts();
        for(Part p :parts) {
        	if(p.getContentType() != null) {
        		String filename = p.getSubmittedFileName();
        		if(filename != null && filename.length()!=0 ) {
        			p.write(filename);
        			out.print("<h3> 업로드한 파일내임 : "+ filename+"</h3>");
        			out.print("<h3> 파일 size : "+p.getSize()+"</h3>");
        			out.print("<img src='c:/upload/"+filename+"'>");
        			
        		}
        	}
        }
        
	}

}


*****************************************************
@WebServlet("/upload2.do")
@MultipartConfig(maxFileSize = 1024*1024*5)
public class UploadServlet2 extends HttpServlet {
	private static final long serialVersionUID = 1L;
       
	protected void doPost(HttpServletRequest request, HttpServletResponse response) 
			                                         throws ServletException, IOException {
		System.out.println("/upload2.do  파일업로드처리");
		response.setContentType("text/html;charset=utf-8");
        request.setCharacterEncoding("utf-8"); 
        
        PrintWriter out  = response.getWriter();

        String name = request.getParameter("name");
        
//        String path = request.getRealPath("/upload/");
        
        String path = request.getSession().getServletContext().getRealPath("/upload/");

        
        System.out.println(path);
        
        Collection<Part> parts = request.getParts();
        for(Part p :parts) {
        	if(p.getContentType() != null) {
        		String filename = p.getSubmittedFileName();
        		if(filename != null && filename.length()!=0 ) {
        			p.write(path+filename);
        			out.print("<h3> 업로드한 파일내임 : "+ filename+"</h3>");
        			out.print("<h3> 파일 size : "+p.getSize()+"</h3>");
        			out.print("<img width=300 height=300 src='./upload/"+filename+"'>");
        		}
        	}
        }
        
	}

}

***************** book img *********************
drop table book;
CREATE TABLE Book (
  bookno      int(4) PRIMARY KEY auto_increment,
  title       VARCHAR(40),
  publisher   VARCHAR(40),
  price       int(8) 
);

insert into book (title,publisher,price) values ('java programming','한빛',900);


----------------------

public class BookVO {
	private int bookno; // int(4) PRIMARY KEY auto_increment,
	private String title; // VARCHAR(40),
	private String publisher; // VARCHAR(40),
	private int price; // int(8)
	private String img; // VARCHAR(40),

----------------------------
public class BookDAO_Mariadb {

   // 등록
   public void bookAdd(BookVO vo) {
		System.out.println("add  "+vo);
		String sql =
		"insert into book (title,publisher,price,img) values (?,?,?,?)";
			ps.setString(1, vo.getTitle());
			ps.setString(2, vo.getPublisher());
			ps.setInt(3, vo.getPrice());
			ps.setString(4, vo.getImg());
			
			row = ps.executeUpdate();
	
	//상세보기
			
public BookVO getBook(int bookno) {
		String sql ="select * fro"
				+ "m book where bookno = ? ";
	
	while(rs.next()) {
				vo = new BookVO();
				vo.setBookno(rs.getInt("bookno"));
				vo.setPrice(rs.getInt("price"));
				vo.setTitle(rs.getString("title"));
				vo.setPublisher(rs.getString("publisher"));
				vo.setImg(rs.getString("img"));
			}


---------------------------

@WebServlet("*.do")
@MultipartConfig(maxFileSize = 1024*1024*5)
public class DispatcherServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

	protected void service(HttpServletRequest request, HttpServletResponse response)
			throws ServletException, IOException {



if (action.equals("/addBook2.do")) {
	        String path = request.getSession().getServletContext().getRealPath("/upload/");

			BookDAO_Mariadb dao = new BookDAO_Mariadb();
			BookService service = new BookServiceImpl(dao);

			String title = request.getParameter("title");
			String publisher = request.getParameter("publisher");
			int price = Integer.parseInt(request.getParameter("price"));
			
			BookVO vo = new BookVO();
			vo.setPrice(price);
			vo.setTitle(title);
			vo.setPublisher(publisher);
			
			
			Collection<Part> parts = request.getParts();
	        for(Part p :parts) {
	        	if(p.getContentType() != null) {
	        		String filename = p.getSubmittedFileName();
	        		vo.setImg(filename);
	        		if(filename != null && filename.length()!=0 ) {
	        			p.write(path+filename);
	        		}
	        	}
	        }
	        
			
			service.bookAdd(vo);
			
			response.sendRedirect("bookList.do");
			return;
		}

----------------------
<section>
<h2> Book 등록</h2>

<form action="addBook2.do" method="post" enctype="multipart/form-data">
    제목: <input type="text"  name="title"> <br/>
    출판사: <input type="text"  name="publisher"> <br/>
    가격: <input type="number"  name="price"> <br/>
    
  <label>첨부파일 : <input type="file" name="img" > </label> <br>
    
  <input type="submit" value="등록"> 
  <input type="reset">
</form>
</section>

--------------------------------
<!-- view Form  -->
	  <form name="f" method="post" action="">
	  <input type="hidden" name="bookno" value="${book.bookno}">
	  <table>
		  <tr>
			<td >도서제목</td>
			<td > ${book.title}	</td>
		  </tr>
		  <tr>
			<td >출판사</td>
			<td >${book.publisher}</td>
		  </tr>
		  <tr>
			<td >가격</td>
			<td >${book.price}</td>
		  </tr>		
		  <tr>
			<td >이미지</td>
			<td ><img alt="" src="./upload/${book.img}" width="200" height="200"></td>
		  </tr>		
		  
	  </table>
	  </form>
	  



*** deploy ***
export / war / 이름지정 source 포함여부 결정 ?

war 파일의 이름이 context 이름이 된다.


tomcat 의 conf/server.xml  port 확인
69라인 
<Connector port="9000" protocol="HTTP/1.1"
               connectionTimeout="20000"
               redirectPort="8443" />


bin/startup.bat
bin/shutdown.bat

weappapps / war 배치하면 deploy 된다.

브라우저로 app 실행시키면서 확인한다.


30시간 동안 진행한내용이 결코 쉬운 내용이 안닌데 , 많은 내용을 진행했습니다.
따라 오느라 수고들 많으셨습니다.

이내용을 이해하고 설명이 가능하다라고 한다면
이분야에서 결코 뒤지지 않을것입니다.

특히 비전공자분들 분명히 힘드셨으겁니다.
정말 대단하다 라고 느끼셔도 됩니다.

코로나앱은 잘만들어졌다기 보다
그시기에 가장 필요로하는 관심 있는 데이터를 
지도에 표시 ~~