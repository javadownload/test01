------------------- bookList.jsp ----------------------

<%@page import="vo.BookVO"%>
<%@page import="java.util.List"%>
<%@page import="dao.BookDAO_JDBC"%>
<%@page import="dao.BookDAO"%>
<%@page import="service.BookServiceImpl"%>
<%@page import="service.BookService"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book List</title>
<link rel="stylesheet" href="./css/table.css">

</head>
<body>
<h1>Book List</h1>

<table class="tableb">
<tr><th>bookno</th> <th>title</th><th>publisher</th><th>price</th></tr>

<%
  // BookDAO dao = new BookDAO_JDBC();
  // BookService service = new BookServiceImpl(dao);
   
  // List<BookVO> list = service.bookList();
   List<BookVO> list = (List<BookVO>)request.getAttribute("bookList");
   for(BookVO data :list){
%>
   <tr>
       <td><%= data.getBookno() %>  </td>
       <td><%= data.getTitle() %>   </td>
       <td><%= data.getPublisher() %>  </td>
       <td><%= data.getPrice() %>  </td>
   </tr>
<%} %>

</table>


</body>
</html>


------------------ListBookServlet----------------------------------
package servlet;
@WebServlet({ "/bookList.do" })
public class ListBookServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;

	protected void service(HttpServletRequest request, 
			               HttpServletResponse response) 
					throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
      
		
		HttpSession session = request.getSession();
		String login = (String) session.getAttribute("login");
		System.out.println("login : "+login);
		if(login == null) {
			//response.sendRedirect("login.jsp");
		         request.setAttribute("msg", "login이 필요합니다.");

			getServletContext().
			getRequestDispatcher("/login.jsp").
			forward(request, response);
			return;
		}
        
		BookDAO dao = new BookDAO_JDBC();
		BookService service = new BookServiceImpl(dao);
		List<BookVO> list = service.bookList();
		
		list.forEach(i -> System.out.println(i));
		
		//PrintWriter out = response.getWriter();
		
		//list.forEach(i -> out.print("<h3>"+i+"</h3>"));

		
		request.setAttribute("bookList", list);
		
		getServletContext().
		getRequestDispatcher("/bookList.jsp").
		forward(request, response);
		
	}

}


--------------------bookList2.jsp----------------------------------------
<%@page import="vo.BookVO"%>
<%@page import="java.util.List"%>
<%@page import="dao.BookDAO_JDBC"%>
<%@page import="dao.BookDAO"%>
<%@page import="service.BookServiceImpl"%>
<%@page import="service.BookService"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8" %>
    
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
 
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book List</title>
<link rel="stylesheet" href="./css/table.css">

</head>
<body>
<h1>Book List</h1>

<table class="tableb">
<tr><th>bookno</th> <th>title</th><th>publisher</th><th>price</th></tr>

<c:forEach  var="data"  items="${bookList}">
   <tr>
       <td>${data.bookno}  </td>
       <td><a href="viewBook.do?bookno=${data.bookno}"> ${data.title} </a>  </td>
       <td>${data.publisher}  </td>
       <td>${data.price}  </td>
   </tr>
</c:forEach>

</table>


</body>
</html>


-------------------------Book 등록 폼 만들어서 -----------------------------
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book</title>
</head>
<body>
	<h2>Book</h2>	
	<form action="insertbook.do" method="post">
		제목 : <input type="text" id="title" name="title"><br/>
		출판사 : <input type="text" name="publisher"></br>
		가격 : <input type="number" name="price"></br>
		<input type="submit" value="전송">
		<input type="reset" value="초기화">
	</form>
</body>
</html>



-----------------------WebServlet({"/insertbook.do" })---------------------------------
package servlet;

@WebServlet({"/insertbook.do" })
public class InsertBookServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
	
	protected void doPost(HttpServletRequest request, 
			              HttpServletResponse response) 
			              throws ServletException, IOException {
		
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		PrintWriter out = response.getWriter();
		
		BookDAO dao = new BookDAO_JDBC();
		BookService service = new BookServiceImpl(dao);
		BookVO vo =  new BookVO();
		vo.setPublisher(request.getParameter("publisher"));
		vo.setPrice(Integer.parseInt(request.getParameter("price")));
		vo.setTitle(request.getParameter("title"));
		try {
			service.bookAdd(vo);
			response.sendRedirect("bookList.do");
			//out.print("<h1>"+i+"개의 row 입력 완료");
		} catch (Exception e) {
			//out.print("<h2> 문제 발생 : "+e);
			request.setAttribute("exception", e);
			
			getServletContext().
			getRequestDispatcher("/error.jsp").
			forward(request, response);
		}
	}
}



--------------------------bookList3.jsp---- 삭제기능 연결  ------------------

<%@page import="vo.BookVO"%>
<%@page import="java.util.List"%>
<%@page import="dao.BookDAO_JDBC"%>
<%@page import="dao.BookDAO"%>
<%@page import="service.BookServiceImpl"%>
<%@page import="service.BookService"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8" %>
    
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
 
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book List</title>
<link rel="stylesheet" href="./css/table.css">

<script type="text/javascript">
   function f1() {
	   return confirm("삭제 할거니?");
   }
</script>

</head>
<body>
<h1>Book List</h1>



<form action="deleteBook.do" method="get">
<table class="tableb">
	<tr><th>bookno</th> <th>title</th><th>publisher</th><th>price</th> 
	              <th><input type="submit" value="삭제" onclick="return f1()"> </th></tr>
	
	<c:forEach  var="data"  items="${bookList}">
	   <tr>
	       <td>${data.bookno}  </td>
	       <td><a href="viewBook.do?bookno=${data.bookno}"> ${data.title} </a>  </td>
	       <td>${data.publisher}  </td>
	       <td>${data.price}  </td>
	       <td> <input type="checkbox" name="bookno" value="${data.bookno}"> </td>
	       
	   </tr>
	</c:forEach>
	
	</table>
</form>

</body>
</html>


-----------------------WebServlet({ "/deleteBook.do" })--------------------------------------

package servlet;

@WebServlet({ "/deleteBook.do" })
public class DeleteBookServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
	protected void service(HttpServletRequest request, 
			              HttpServletResponse response) 
			              throws ServletException, IOException {
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		PrintWriter out = response.getWriter();
		
		BookDAO dao = new BookDAO_JDBC();
		BookService service = new BookServiceImpl(dao);
		String[] nums =  request.getParameterValues("bookno");
		try {
			for(String n : nums)
			service.deleteBook(Integer.parseInt(n));
			
			response.sendRedirect("bookList.do");
			//out.print("<h1>"+i+"개의 row 입력 완료");
		} catch (Exception e) {
			//out.print("<h2> 문제 발생 : "+e);
			request.setAttribute("exception", e);
			
			getServletContext().
			getRequestDispatcher("/error.jsp").
			forward(request, response);
		}
	}
}

--------------el_test-----스프링교재 306 참조---------------------------------


<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
    
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>test el foreach</title>
</head>
<body>

<%
   String[] names = {"홍길동","고길동"};
   request.setAttribute("listname", names);
%>

<c:forEach  var="data" items="${listname}">
    <h3> ${data} </h3>
</c:forEach>

<hr>
<c:forEach begin="1" end="9" step="2" var="data">
    ${data}
</c:forEach>


<hr>
<%= request.getAttribute("listname") %>
<hr>
 ${listname} 
<hr>
${2+3+6}
<hr>
${2 lt 3} 
<hr>
<%= request.getParameter("id") %>
<hr>
${param.id}
<hr>
 
</body>
</html>









