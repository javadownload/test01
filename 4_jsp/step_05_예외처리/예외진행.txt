---error.jsp -----------

<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page isErrorPage="true" %>
   
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
    

<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Book App</title>

<link rel="stylesheet" href="./css/button.css">
<link rel="stylesheet" href="./css/table.css">
<link rel="stylesheet" href="./css/main.css">
    
    
    
</head>
<body>
<%@ include file="common/header.jsp" %>

<div id="output">
<section>

<h3> Error page</h3>
<h4 style="color: red;"> 서버 점검 중입니다. </h4>
<div style="color: red;"> <%= exception %> </div>
<div style="color: red;"> ${exception} </div>



</section>
</div>
<%@ include file="common/footer.jsp" %>


</body>
</html>



----------------------------------
public interface BookService {
	
	 List<BookVO> bookList();
	 void bookAdd(BookVO vo) throws Exception;
	 void deleteBook(int bookno);
	 void updateBook(BookVO vo);
	 
	 List<BookVO> searchBook(String condition,String keyword);
}
--------------------------------------
public void bookAdd(BookVO vo) throws Exception{
        String sql = "insert into book (bookno ,title,publisher,price) " + 
        		"values ((select nvl(max(bookno),0)+1 from book)  ,?,?,?)";
	~~~~


                         int i = ps.executeUpdate();
			if(i == 0) throw new Exception("등록 실패");
		} catch (Exception e) {
			//System.out.println(e);
			throw e;
		}finally {
			JDBCUtil.close(rs, ps, con);
		}


-----------------InsertBookServlet--------------------
@WebServlet({"/insertbook.do" })
public class InsertBookServlet extends HttpServlet {
	private static final long serialVersionUID = 1L;
	
	protected void doPost(HttpServletRequest request, 
			              HttpServletResponse response) 
			              throws ServletException, IOException {
		
		request.setCharacterEncoding("utf-8");
		response.setContentType("text/html;charset=utf-8");
		PrintWriter out = response.getWriter();
		
		BookDAO dao = new BookDAO_JDBC();
		BookService service = new BookServiceImpl(dao);
		BookVO vo =  new BookVO();
		vo.setPublisher(request.getParameter("publisher"));
		vo.setPrice(Integer.parseInt(request.getParameter("price")));
		vo.setTitle(request.getParameter("title"));
		try {
			service.bookAdd(vo);
			response.sendRedirect("bookList.do");
			//out.print("<h1>"+i+"개의 row 입력 완료");
		} catch (Exception e) {
			//out.print("<h2> 문제 발생 : "+e);
			request.setAttribute("exception", e);
			
			getServletContext().
			getRequestDispatcher("/error.jsp").
			forward(request, response);
		}
	}
}

